# **TomatoMonkey 产品需求文档 (PRD)**

### **1. 目标与背景上下文**

#### **目标**
* **业务目标**：提供一个有效的工具，帮助用户提升至少15%的工作/学习效率。
* **用户目标**：让用户感受到对时间的掌控力增强，减少因网络分心而产生的焦虑感。

#### **背景上下文**
在当今的数字化工作与学习环境中，用户普遍面临由网络信息过载导致的注意力分散问题，这直接影响了生产力和任务完成质量。现有的效率工具往往功能繁杂、配置流程长，反而成为一种新的负担。

为了解决这一痛点，TomatoMonkey 项目旨在提供一个轻量级、无缝集成的 Tampermonkey 脚本。它通过将番茄钟、任务管理和网站白名单功能相结合，为用户在浏览器内创造一个“沉浸式”的专注环境，帮助用户以最小的认知成本对抗干扰，高效地完成任务。

#### **变更日志**

| 日期 | 版本 | 描述 | 作者 |
| :--- | :--- | :--- | :--- |
| 2025年9月8日 | 1.0 | 初始草稿创建 | John (PM) |
| 2025年9月8日 | 1.1 | 根据用户反馈修订故事顺序 | John (PM) |

### **2. 需求**

#### **功能性需求 (FR)**
* **FR1**: 用户必须能够在一个列表中创建、删除和标记（完成/未完成）任务。
* **FR2**: 已完成的任务必须能够展示其关联的番茄时间统计，并在列表中自动排序。
* **FR3**: 系统必须提供一个网站白名单管理功能，允许用户添加和删除域名，采用包含匹配（contains）方式。
* **FR4**: 用户必须能够为一个或多个选定的任务启动一个可配置的番茄时钟。
* **FR5**: 番茄时钟计时结束后，系统必须能通过浏览器 Notification API 发送桌面通知。
* **FR6**: 在番茄时钟运行期间，任何对非白名单网站的访问都必须被拦截。
* **FR7**: 访问被拦截时，页面必须自动跳转到一个“专注页面”，该页面显示当前任务、剩余时间以及会话控制选项。
* **FR8**: 番茄会话结束后，用户必须可以手动选择“完成任务”、“放弃任务”或“继续工作”。
* **FR9**: 系统必须提供一个统计页面，展示每日和累计的效率数据，并包含一个最近7天的趋势图表。
* **FR10**: 所有功能（任务、白名单、统计）必须集成在一个带左侧标签页的统一设置面板中。
* **FR11**: 用户必须能从“专注页面”直接跳转到设置面板。

#### **非功能性需求 (NFR)**
* **NFR1**: 所有用户数据（任务、白名单、统计）必须存储在浏览器本地存储中，不得依赖任何外部服务器。
* **NFR2**: 界面设计必须简洁、直观、易于使用，最大程度减少用户的认知负荷。
* **NFR3**: 脚本必须是轻量级的，其运行不得对浏览器的正常性能产生可感知的负面影响。
* **NFR4**: 脚本必须在主流桌面浏览器（Chrome, Firefox, Edge）的最新版本上稳定运行。
* **NFR5**: 脚本必须完全在 Tampermonkey 环境下运行。

### **3. 用户界面设计目标**

* **整体UX愿景**: 打造一个无干扰、功能聚焦的工具。用户交互应尽可能地快和直接，避免不必要的操作步骤。
* **关键交互范式**:
    * **设置面板**: 采用左侧垂直标签页导航（ToDo列表、网站白名单、效率统计），内容区在右侧显示，结构清晰。
    * **计时器**: 视觉上清晰地展示剩余时间，状态（运行中/暂停/结束）一目了然。
* **核心屏幕/视图**:
    * **设置面板**: 包含所有功能的配置界面。
    * **专注页面**: 在番茄钟运行时作为用户的“安全区”，展示核心信息和控制选项。
* **无障碍性**: 满足基本的WCAG AA标准，确保键盘可导航，颜色对比度充足。
* **品牌**: 风格极简，可点缀番茄主题色（如红色、绿色）作为强调色。
* **目标平台**: 桌面浏览器。

### **4. 技术假设**

* **仓库结构**: 单一代码仓库。
* **服务架构**: 纯客户端脚本架构，无后端服务。
* **测试需求**: 对核心逻辑（如计时器、数据处理）进行单元测试。UI 交互和网站拦截功能以手动端到端测试为主。
* **附加假设**:
    * 使用 Tampermonkey 提供的 API (如 `GM_setValue`, `GM_getValue`) 进行数据持久化。
    * 统计图表将使用一个轻量级的JS图表库。

### **5. Epic 列表**
* **Epic 1: MVP - 核心专注体验**
    * **目标**: 交付一个功能完整的 Tampermonkey 脚本，该脚本集成了任务列表、番茄钟和网站拦截功能，为用户提供一套完整的专注力管理工具。

### **6. Epic 1: MVP - 核心专注体验 (故事拆分 - 修订版)**

#### **Story 1.1: 设置面板框架与ToDo列表功能**
* **描述**: 作为一个需要专注的用户，我想要一个带标签页的设置面板，并且首先能在其中管理我的 ToDo 列表，以便我能在一个统一的界面开始组织任务。
* **验收标准**:
    1.  实现一个基础的设置面板UI，包含左侧垂直导航区域和右侧内容区域。
    2.  左侧导航栏包含三个标签页入口：‘ToDo列表’、‘网站白名单’、‘效率统计’。
    3.  在‘ToDo列表’标签页中，用户可以输入任务标题并添加新任务。
    4.  每个任务前有一个复选框，用户可以勾选来标记任务为“完成”。
    5.  每个任务旁有一个删除按钮。
    6.  已完成的任务会自动移动到列表底部，并按完成时间倒序排列。
    7.  所有任务数据在刷新页面后必须持久化。

#### **Story 1.2: 网站白名单配置**
* **描述**: 作为一个需要专注的用户，我想要在设置面板中配置网站白名单，以便我可以定义专注期间允许访问的网站。
* **验收标准**:
    1.  在‘网站白名单’标签页中，用户可以输入域名并添加到白名单列表中。
    2.  用户可以从列表中删除已添加的域名。
    3.  白名单采用包含匹配方式（例如 `google.com` 可以匹配 `api.google.com`、`contentgoogle.com`、`google.com.hk`）。
    4.  白名单数据在刷新页面后必须持久化。

#### **Story 1.3: 专注页面UI与核心番茄钟**
* **描述**: 作为一个需要专注的用户，我想要一个独立的专注页面，并且能为一个任务启动番茄钟，以便我能进入一个无干扰的计时环境。
* **验收标准**:
    1.  实现一个基础的“专注页面”UI，页面上需包含区域用于显示当前任务和倒计时。
    2.  在‘ToDo列表’的每个未完成任务旁，有一个“开始专注”按钮。
    3.  点击“开始专注”按钮后，番茄钟开始计时（默认25分钟），并立即跳转到“专注页面”。
    4.  计时结束后，浏览器会弹出一个桌面通知，提示“专注时间结束”。

#### **Story 1.4: 网站拦截逻辑实现**
* **描述**: 作为一个需要专注的用户，我想要在番茄钟运行时自动屏蔽无关网站，以便我能免受干扰。
* **验收标准**:
    1.  当番茄钟正在运行时，在任何标签页中尝试访问不在白名单中的网址，都会被拦截。
    2.  被拦截后，该标签页会自动跳转到“专注页面”。
    3.  “专注页面”上提供“提前完成”和“放弃”任务的按钮。
    4.  “专注页面”右上角有一个设置图标，点击可以打开设置面板。

#### **Story 1.5: 会话结束流程**
* **描述**: 作为一个需要专注的用户，我想要在专注结束后明确地处理我的任务，以便我的任务状态得到正确更新。
* **验收标准**:
    1.  当番茄钟倒计时结束或用户点击“提前完成”/“放弃”时，倒计时停止。
    2.  页面上出现选项：“完成任务”、“放弃任务”、“继续工作5分钟”。
    3.  点击“完成任务”，对应任务状态变为“已完成”，并记录本次番茄钟时间。
    4.  点击“放弃任务”，任务状态不变，不记录时间。
    5.  点击“继续工作”，计时器重置为5分钟并重新开始。
    6.  用户做出选择后，专注流程结束。

#### **Story 1.6: 效率统计**
* **描述**: 作为一个需要专注的用户，我想要查看我的效率统计数据，以便我能跟踪我的进展并获得激励。
* **验收标准**:
    1.  在‘效率统计’标签页中，显示四个核心指标：今日完成任务数、累计完成任务数、今日专注分钟数、累计专注分钟数。
    2.  页面上有一个图表，以天为单位，显示最近7天内每天完成的任务数和专注分钟数。
    3.  所有统计数据都基于已“完成”的任务。
