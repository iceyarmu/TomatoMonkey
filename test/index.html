<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TomatoMonkey æµ‹è¯•é¡µé¢</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
          sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 40px 20px;
        background: #f5f5f5;
      }
      .container {
        background: white;
        border-radius: 12px;
        padding: 40px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #d95550;
        margin-bottom: 10px;
      }
      .emoji {
        font-size: 48px;
        margin-bottom: 20px;
      }
      .info {
        background: #fef5e7;
        border-left: 4px solid #d95550;
        padding: 20px;
        margin: 20px 0;
        border-radius: 4px;
      }
      .info h3 {
        margin-top: 0;
        color: #d95550;
      }
      .steps {
        background: #f0f7ff;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }
      .steps ol {
        margin: 10px 0;
        padding-left: 20px;
      }
      .steps li {
        margin: 10px 0;
        line-height: 1.6;
      }
      code {
        background: #f5f5f5;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: "Consolas", "Monaco", monospace;
        color: #d14;
      }
      .status {
        padding: 15px;
        background: #f0f0f0;
        border-radius: 8px;
        margin-top: 20px;
      }
      .status-item {
        display: flex;
        align-items: center;
        margin: 8px 0;
      }
      .status-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 10px;
      }
      .status-indicator.active {
        background: #4caf50;
        animation: pulse 2s infinite;
      }
      .status-indicator.inactive {
        background: #999;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }
      .button {
        display: inline-block;
        padding: 10px 20px;
        background: #d95550;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        margin: 10px 10px 10px 0;
        transition: background 0.2s;
      }
      .button:hover {
        background: #c94943;
      }
      .test-section {
        margin-top: 30px;
        padding: 20px;
        background: #fafafa;
        border-radius: 8px;
      }
      .test-section h3 {
        color: #666;
        margin-top: 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="emoji">ğŸ…</div>
      <h1>TomatoMonkey æµ‹è¯•é¡µé¢</h1>
      <p>æ¬¢è¿ä½¿ç”¨ TomatoMonkey å¼€å‘è°ƒè¯•ç¯å¢ƒï¼</p>

      <div class="info">
        <h3>ğŸ“Œ å½“å‰çŠ¶æ€</h3>
        <div class="status">
          <div class="status-item">
            <span class="status-indicator active"></span>
            <span>å¼€å‘æœåŠ¡å™¨è¿è¡Œä¸­ (ç«¯å£: 4005)</span>
          </div>
          <div class="status-item">
            <span class="status-indicator" id="script-status"></span>
            <span id="script-text">æ£€æµ‹ Tampermonkey è„šæœ¬...</span>
          </div>
        </div>
      </div>

      <div class="steps">
        <h3>ğŸš€ å¦‚ä½•è°ƒè¯• TomatoMonkey</h3>
        <ol>
          <li>ç¡®ä¿æµè§ˆå™¨å·²å®‰è£… <strong>Tampermonkey</strong> æ‰©å±•</li>
          <li>
            ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å®‰è£…/æ›´æ–°ç”¨æˆ·è„šæœ¬ï¼š<br />
            <a href="http://127.0.0.1:4005/tomatomonkey.user.js" class="button"
              >å®‰è£… TomatoMonkey è„šæœ¬</a
            >
          </li>
          <li>åˆ·æ–°æœ¬é¡µé¢ï¼Œè„šæœ¬å°†è‡ªåŠ¨åŠ è½½</li>
          <li>
            ä½¿ç”¨å¿«æ·é”® <code>Ctrl+Shift+T</code> æˆ–ç‚¹å‡»å³ä¸Šè§’çš„ ğŸ…
            æŒ‰é’®æ‰“å¼€è®¾ç½®é¢æ¿
          </li>
          <li>æˆ–è€…é€šè¿‡ Tampermonkey èœå•è®¿é—®è®¾ç½®</li>
        </ol>
      </div>

      <div class="test-section">
        <h3>ğŸ§ª æµ‹è¯•åŒºåŸŸ</h3>
        <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•åŒºåŸŸï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæµ‹è¯• TomatoMonkey çš„å„ç§åŠŸèƒ½ã€‚</p>
        <p>è„šæœ¬ä¼šåœ¨æ‰€æœ‰ç½‘ç«™ä¸Šè¿è¡Œï¼Œä½†åœ¨è¿™ä¸ªæµ‹è¯•é¡µé¢ä¸Šæ‚¨å¯ä»¥å®‰å…¨åœ°è¿›è¡Œè°ƒè¯•ã€‚</p>

        <div style="margin-top: 20px">
          <button
            onclick="testNotification()"
            class="button"
            style="background: #4caf50"
          >
            æµ‹è¯•é€šçŸ¥
          </button>
          <button
            onclick="checkScriptStatus()"
            class="button"
            style="background: #2196f3"
          >
            æ£€æŸ¥è„šæœ¬çŠ¶æ€
          </button>
        </div>
      </div>
    </div>

    <script>
      // æ£€æŸ¥è„šæœ¬æ˜¯å¦åŠ è½½
      function checkScriptStatus() {
        const indicator = document.getElementById("script-status");
        const text = document.getElementById("script-text");

        if (typeof window.TomatoMonkeyApp !== "undefined") {
          indicator.classList.add("active");
          text.textContent = "TomatoMonkey è„šæœ¬å·²åŠ è½½ âœ…";
          console.log("TomatoMonkey App:", window.TomatoMonkeyApp);
        } else {
          indicator.classList.add("inactive");
          text.textContent = "TomatoMonkey è„šæœ¬æœªæ£€æµ‹åˆ° âŒ";
        }
      }

      // æµ‹è¯•é€šçŸ¥
      function testNotification() {
        if (typeof GM_notification !== "undefined") {
          GM_notification({
            title: "TomatoMonkey",
            text: "é€šçŸ¥åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼",
            timeout: 3000,
          });
        } else {
          alert("GM_notification ä¸å¯ç”¨ï¼Œè¯·ç¡®ä¿è„šæœ¬å·²æ­£ç¡®åŠ è½½");
        }
      }

      // é¡µé¢åŠ è½½åæ£€æŸ¥çŠ¶æ€
      window.addEventListener("load", () => {
        setTimeout(checkScriptStatus, 1000);
      });

      // ç›‘å¬è„šæœ¬åŠ è½½äº‹ä»¶
      document.addEventListener("tomato-monkey-initialized", () => {
        checkScriptStatus();
      });
    </script>
  </body>
</html>
